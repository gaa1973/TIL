# JWT での認証プログラム作成

## JWT について

✅ JWT 認証が一般的になった理由
ステートレスな認証方式 JWT はトークン自体にユーザー情報を含むため、サーバー側でセッション情報を保持する必要がありません。これにより、サーバーの負荷が軽減され、スケーラビリティが向上します。

SPA やモバイルアプリとの相性が良い ページ遷移が少ない SPA では、従来のセッション管理が難しくなるため、クライアント側でトークンを保持できる JWT が適しています。

API 連携に強い 複数のサービス間で認証情報を共有する際、JWT は標準化された形式で安全に情報をやり取りできるため、OAuth や OpenID Connect と組み合わせて使われることが多いです。

⚠️ 注意点と課題
万能ではない JWT に動的な情報（例：ユーザーの権限やアクセス可能なリソース）を含めると、情報の整合性が崩れるリスクがあります。トークンの有効期限内にユーザーの状態が変わっても、古い情報のまま動作してしまう可能性があるため、認証と認可は分離して設計することが推奨されています。

セキュリティ設計が重要 トークンの漏洩や改ざんを防ぐために、署名の検証や HTTPS 通信の徹底が必要です。また、トークンの有効期限やリフレッシュの仕組みも慎重に設計する必要があります。

# 🌐 基本の HTTP メソッド（REST API）

Node.js で Express などのフレームワークを使って API を構築すると、以下のような HTTP メソッドが使われます：

メソッド 用途例
GET データ取得（例：ユーザー情報を取得）
POST データ作成（例：新しい投稿を作成）
PUT データ更新（例：プロフィールを更新）
DELETE データ削除（例：投稿を削除）
これらは RESTful API の基本で、フロントとバックエンドの通信の中心になります。

# 🔐 ログイン処理のシーケンス（JWT 認証）

コード
ユーザー → フロントエンド → バックエンド → データベース

1. ユーザーがログインフォームにメールとパスワードを入力
   → フロントエンドがそれを受け取る

2. フロントエンドが /api/login に POST リクエストを送信
   リクエストボディ：{ email, password }

3. バックエンド（Node.js）がリクエストを受け取り、データベースでユーザー情報を照合
   パスワードはハッシュ化されているので、bcrypt.compare() などで検証

4. 認証成功 → JWT トークンを生成
   jsonwebtoken.sign() を使ってトークンを作成

トークンには userId や email などの情報を含める

5. バックエンドがトークンをレスポンスとして返す
   レスポンス：{ token: "xxxxx.yyyyy.zzzzz" }

6. フロントエンドがトークンを受け取り、ローカルストレージや Cookie に保存
   → 以降の API リクエストに Authorization: Bearer トークン を付けて送信

7. バックエンドはトークンを検証し、ユーザー情報にアクセス可能に
   → 認証された状態でデータ取得や更新が可能になる

感想　 TypeScript のバージョン不整合等のため、１からの環境構築は断念。
　　　 Progate で動いている物から修正して明日以降につなげる。
